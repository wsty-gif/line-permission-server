<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>串焼き店レシピマニュアル</title>
  <style>
    body{
      font-family:-apple-system,BlinkMacSystemFont,"Noto Sans JP",sans-serif;
      margin:0;background:#f8f9fa;color:#111;
      line-height:1.7;font-size:16px;
    }
    .wrapper{max-width:520px;margin:0 auto;padding:14px;}
    h1{text-align:center;font-size:20px;color:#e11d48;margin-bottom:8px;}
    .section{
      background:#fff;border-radius:12px;
      margin-bottom:14px;overflow:hidden;
      box-shadow:0 1px 6px rgba(0,0,0,0.1);
    }
    .header{
      padding:12px;display:flex;justify-content:space-between;
      cursor:pointer;user-select:none;
      background:#fff;
    }
    .header-title{font-size:16px;font-weight:600;}
    .arrow{transition:0.2s;}
    .open .arrow{transform:rotate(90deg);}
    .body{display:none;padding:12px;background:#f9fafb;}
    .open .body{display:block;}
    .img-box{
      margin-top:10px;border-radius:10px;background:#e5e7eb;
      padding:10px;display:flex;gap:10px;
    }
    .img-thumb{
      width:80px;height:80px;background:#d1d5db;
      border-radius:8px;display:flex;
      justify-content:center;align-items:center;
      font-size:12px;text-align:center;padding:4px;
    }
    .steps{margin-top:8px;}
    .steps li{margin-bottom:6px;font-size:14px;}
    .point{
      margin-top:10px;padding:10px;background:#fff7ed;
      border-left:4px solid #fb923c;border-radius:6px;
      font-size:14px;color:#b45309;
    }
    .sub-title{font-size:14px;color:#6b7280;margin-bottom:4px;}
  </style>
<script>
    async function loadChecks() {
      const userId = window.MANUAL_USER_ID;
      const store  = window.MANUAL_STORE;
      const type   = window.MANUAL_TYPE;

      if (!userId || !store || !type) {
        console.warn("チェックロード不可: userId/store/type が不足");
        return;
      }

      const res = await fetch(
        `/${store}/api/manual-check?userId=${userId}&type=${type}`
      );
      // 🔽 JSON 以外は無視（HTMLが返ってきても落ちない）
      const contentType = res.headers.get("content-type") || "";
      if (!contentType.includes("application/json")) {
        console.warn("manual-check が JSON を返していません");
        return;
      }

      const data = await res.json();

      // 反映
      document.querySelectorAll(".check-item").forEach(el => {
        const key = el.dataset.key;
        el.checked = data[key] === true;
      });
    }


    // チェック変更イベント
    async function toggleCheck(key) {
      const userId = window.MANUAL_USER_ID;
      const store  = window.MANUAL_STORE;   // ← これを必ず使う
      const type   = window.MANUAL_TYPE;

      if (!userId || !store || !type) {
        console.warn("toggleCheck: 必要な情報が不足しています");
        return;
      }

      const res = await fetch(`/${store}/manual-check`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          userId,
          type,
          recipeId: key
        })
      });

      const out = await res.json();
      console.log("CHECK UPDATED:", out);
    }



    window.addEventListener("DOMContentLoaded", loadChecks);
  </script>

  <script>
    function saveCheck(key) {
      toggleCheck(key);
    }
  </script>
</head>
<body>

<div class="wrapper">
  <h1>串焼きレシピマニュアル</h1>
  <p style="text-align:center;font-size:13px;color:#6b7280;margin-bottom:18px;">
    スマホでサッと確認できる、店舗向け公式レシピ集です。
  </p>

  <!-- 1. ねぎま -->
  <div class="section">
    <div class="header">
      <div>
        <div class="header-title recipe-name" data-recipe-id="ねぎま（鶏もも × 長ねぎ）">ねぎま（鶏もも × 長ねぎ）</div>
        <div class="sub-title">人気No.1の基本串</div>
      </div>
      <div class="arrow">▶</div>
    </div>
    <div class="body">
      <strong>材料（1本）</strong><br>
      ・鶏もも角切り：20g × 2  
      ・長ねぎ：2切れ  

      <div class="img-box">
        <div class="img-thumb">画像を入れる</div>
        <div>
          <strong>盛り付け完成例</strong><br>
          店舗の写真に差し替えてください
        </div>
      </div>

      <ol class="steps">
        <li>鶏もも → 長ねぎ → 鶏ももの順に刺す</li>
        <li>塩振りは片面 2振りずつ、全体にまんべんなく</li>
        <li>強火で皮面を3分焼き、裏返して2分</li>
        <li>最後に中火で1分。肉がぷっくりしたらOK</li>
      </ol>

      <div class="point">
        ✔ 長ねぎは焼き過ぎると崩れるので裏返しは1回だけ  
        ✔ 肉は刺し過ぎずふんわり刺すと火が通りやすい
      </div>
      <div class="check-wrap">
        <input type="checkbox" class="check-item" data-key="ねぎま（鶏もも × 長ねぎ）" onclick="toggleCheck('ねぎま（鶏もも × 長ねぎ）')">
        <label for="chk-potato">この項目を理解しました</label>
      </div>
    </div>
  </div>

  <!-- 2. 砂ずり -->
  <div class="section">
    <div class="header">
      <div>
        <div class="header-title recipe-name" data-recipe-id="砂ずり（砂肝）">砂ずり（砂肝）</div>
        <div class="sub-title">歯ごたえが命の定番串</div>
      </div>
      <div class="arrow">▶</div>
    </div>
    <div class="body">
      <strong>材料（1本）</strong><br>
      ・砂肝スライス：15g × 3  

      <div class="img-box">
        <div class="img-thumb">画像を入れる</div>
        <div><strong>焼き目の目安</strong><br>表面が薄く白くなる程度</div>
      </div>

      <ol class="steps">
        <li>硬すぎる部分は薄く下処理する</li>
        <li>串には縦方向に刺し、外れにくくする</li>
        <li>塩は強め（片面 3振り）</li>
        <li>強火で片面 2分 → 1分 → 軽く押して弾力あればOK</li>
      </ol>

      <div class="point">
        ✔ 焼きすぎると固くなるので「短時間で高火力」が基本  
        ✔ 焼き上がりはキュッと弾力が出た状態
      </div>
      <div class="check-wrap">
        <input type="checkbox" class="check-item" data-key="砂ずり（砂肝）" onclick="toggleCheck('砂ずり（砂肝）')">
        <label for="chk-potato">この項目を理解しました</label>
      </div>
    </div>
  </div>

  <!-- 3. つくね -->
  <div class="section">
    <div class="header">
      <div>
        <div class="header-title recipe-name" data-recipe-id="自家製つくね">自家製つくね</div>
        <div class="sub-title">ふわふわ食感が人気</div>
      </div>
      <div class="arrow">▶</div>
    </div>
    <div class="body">
      <strong>材料（1本）</strong><br>
      ・つくねタネ：35g  
      ・タレ or 塩  

      <div class="img-box">
        <div class="img-thumb">画像を入れる</div>
        <div><strong>焼き上がりの目安</strong><br>表面がこんがり・内部はふんわり</div>
      </div>

      <ol class="steps">
        <li>手に水をつけ、丸めて空気を抜く</li>
        <li>形は平たい楕円形にすると火が通りやすい</li>
        <li>中火で2分 → 裏返し2分 → 弱火で1分蒸し焼き</li>
        <li>タレの場合は最後に2度付けして焼く</li>
      </ol>

      <div class="point">
        ✔ 生焼け防止のため中央を軽く押し、透明な肉汁が出ればOK  
        ✔ タレは焦げやすいので最後に絡める
      </div>
      <div class="check-wrap">
        <input type="checkbox" class="check-item" data-key="自家製つくね" onclick="toggleCheck('自家製つくね')">
        <label for="chk-potato">この項目を理解しました</label>
      </div>
    </div>
  </div>

  <!-- 4. ささみ -->
  <div class="section">
    <div class="header">
      <div>
        <div class="header-title recipe-name" data-recipe-id="ささみ（梅・わさび・しそ）">ささみ（梅・わさび・しそ）</div>
        <div class="sub-title">レア感が勝負の繊細な串</div>
      </div>
      <div class="arrow">▶</div>
    </div>
    <div class="body">
      <strong>材料（1本）</strong><br>
      ・ささみ：18g × 2  
      ・味付け（梅・わさび・しそ）  

      <div class="img-box">
        <div class="img-thumb">画像</div>
        <div><strong>火入れのコツ</strong><br>外は白く、中は薄いピンクがベスト</div>
      </div>

      <ol class="steps">
        <li>筋をしっかり取り、厚さを均一にする</li>
        <li>塩は控えめ（片面1振り）</li>
        <li>弱火で3分 → 返して2分</li>
        <li>梅・わさびは焼き上がり後に乗せる</li>
      </ol>

      <div class="point">
        ✔ 焼きすぎるとパサつくため火加減は必ず弱火  
        ✔ 店舗の衛生ルールに合わせてレア度を調整
      </div>
      <div class="check-wrap">
        <input type="checkbox" class="check-item" data-key="ささみ（梅・わさび・しそ）" onclick="toggleCheck('ささみ（梅・わさび・しそ）')">
        <label for="chk-potato">この項目を理解しました</label>
      </div>
    </div>
  </div>

  <!-- 5. 豚バラ -->
  <div class="section">
    <div class="header">
      <div>
        <div class="header-title recipe-name" data-recipe-id="豚バラ串">豚バラ串</div>
        <div class="sub-title">脂の旨味を楽しむボリューム串</div>
      </div>
      <div class="arrow">▶</div>
    </div>
    <div class="body">
      <strong>材料（1本）</strong><br>
      ・豚バラ：20g × 2  

      <div class="img-box">
        <div class="img-thumb">画像</div>
        <div><strong>焼き色目安</strong><br>脂が透き通り、表面がカリッと</div>
      </div>

      <ol class="steps">
        <li>脂が多い場合は少しカットしてバランス調整</li>
        <li>強火で皮面をしっかり焼いて脂を落とす</li>
        <li>裏面は中火でサッと焼く（1〜2分）</li>
        <li>塩は強めが合う（片面3振り）</li>
      </ol>

      <div class="point">
        ✔ 焼き過ぎると硬くなるので焦げ目がついたらすぐ返す  
        ✔ 火柱が上がりやすいので位置調整を徹底
      </div>
      <div class="check-wrap">
        <input type="checkbox" class="check-item" data-key="豚バラ串" onclick="toggleCheck('豚バラ串')">
        <label for="chk-potato">この項目を理解しました</label>
      </div>
    </div>
  </div>

</div>

<script>
	document.querySelectorAll(".section").forEach(sec => {
	sec.querySelector(".header").addEventListener("click", (e) => {
		const isOpen = sec.classList.contains("open");
		sec.classList.toggle("open");

		// すでに開いている時 → 何もしない
		if (isOpen) return;

		// 開いた瞬間に位置を補正
		setTimeout(() => {
		const rect = sec.getBoundingClientRect().top + window.scrollY;
		const offset = 80; // ← 上からどれくらい余白を空けるか（sticky対策）
		window.scrollTo({
			top: rect - offset,
			behavior: "smooth"
		});
		}, 10);
	});
	});

</script>

</body>
</html>
